<!-- TOC START min:1 max:3 link:true update:true -->
- [Login](#login)
- [Register](#register)
- [Change Password](#change-password)
- [Change Display Name](#change-display-name)
- [Create Itinerary](#create-itinerary)
- [Create Event](#create-event)
- [Update Event](#update-event)
- [Get Suggestions](#get-suggestions)
- [Invite to Event](#invite-to-event)
- [Get Event from ID](#get-event-from-id)
- [Get Events For Itinerary](#get-events-for-itinerary)
- [Get Itinerary from ID](#get-itinerary-from-id)
- [Delete Itinerary](#delete-itinerary)
- [Get Itinerary List](#get-itinerary-list)
- [Rate Place](#rate-place)
- [Yelp Integration (Depreciated)](#yelp-integration-depreciated)
    - [API Website](#api-websitehttpsgithubcomyelpyelp-python)
- [Object Mappings](#object-mappings)
  - [User Object](#user-object)
  - [Itinerary Object](#itinerary-object)
  - [Event Object](#event-object)

<!-- TOC END -->



# Login
----
  Returns user info if login successful.

* **URL**

  /login

* **Method:**

  `POST`

* **Data Params**
    ```javascript
    { "username": username,
      "password": password}
    ```

* **Success Response Code:** 200 OK  
    **Content:** See [User Object](#user-object)

* **Error Response:**

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Invalid username" }`

  OR

  * **Code:** 401 UNAUTHORIZED <br />
    **Content:** `{ error : "Incorrect password" }`

* **Sample Call:**

# Register
----
  Returns user info if registration successful.

* **URL**

  /register

* **Method:**

  `POST`

* **Data Params**

    ```javascript
    { "username": username,
      "password": password,
      "name": name,
      "displayName": displayName }
    ```

* **Success Response Code:** 201 CREATED  
    **Content:** See [User Object](#user-object)

* **Error Response:**

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "User already exists" }`

* **Sample Call:**

# Change Password
----
  Returns user info if change password successful.

* **URL**

  /changePassword/\<username\>

* **Method:**

  `POST`

* **Data Params**

    ```javascript
    { "old_password": old_password,
      "new_password": new_password }
    ```

* **Success Response Code:** 200 OK  
    **Content:** See [User Object](#user-object)

* **Error Response:**

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Invalid username" }`

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Incorrect password" }`

# Change Display Name
----
  Returns user info if change display name successful.

* **URL**

  /changeDisplayName/\<username\>

* **Method:**

  `POST`

* **Data Params**

    ```javascript
    { "password": old_password,
      "displayName": display_name }
    ```

* **Success Response Code:** 200 OK  
    **Content:** See [User Object](#user-object)

* **Error Response:**

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Invalid username" }`

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Incorrect password" }`

# Create Itinerary
----
  Creates a day itinerary for the user.

* **URL**

  /createItinerary/\<username\>

* **Method:**

  `POST`

* **Data Params**

    ```javascript
    { "name" : itinerary_name,
      "date": itinerary_date}
    ```

* **Success Response Code:** 201 CREATED  
    **Content:** See [Itinerary Object](#itinerary-object)

* **Error Response:**

   * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Itinerary date already in use" }`

# Create Event
----
  Creates an event for the user without the Yelp location ID,
  or accepts an already created event invitation,
  which also creates a new event for the user.

* **URL**

  /createEvent/\<username\>

* **Method:**

  `POST`

* **Data Params**

  For a completely new event  
    ```javascript
    { "start" : start_date,
      "end": end_date,
      "date": itinerary_date }
    ```

  For accepting an invitation  
    ```javascript
    { "uid": event_uid }
    ```

* **Success Response Code:** 201 CREATED  
    **Content:** See [Event Object](#event-object)

* **Error Response:**

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Invalid date range" }`

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Collision with another event" }`

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Itinerary for the day not found" }`

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "User is not invited" }`

# Update Event
----
  Updates the event with the chosen suggestion (i.e. Yelp location).

* **URL**

  /updateEvent/\<username\>

* **Method:**

  `POST`

* **Data Params**  
`suggestionId` is generated by calling [/getSuggestions](#get-suggestions)  
`choice` is the index of selected suggestion (0-3).
    ```javascript
    { "uid": event_uid,
      "choice": 0-3,
      "suggestionId": suggestionId }
    ```

* **Success Response Code:** 200 OK  
    **Content:** See [Event Object](#event-object)

* **Error Response:**

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Event not found" }`

# Get Suggestions
----
  Makes 3 location suggestions for a provided `query` string.  
  Uses the ML algorithm in the backend.

* **URL**

  /getSuggestions/\<username\>

* **Method:**

  `GET`

* **Data Params**  

    ```javascript
    { "uid": event_uid,
      "query": query_string }
    ```

* **Success Response Code:** 200 OK  
    **Content:**  
    * Contains 3 `business` objects and 3 `scores`  
    * `scores` are double values from 0 to 1 (1 being best choice, 0  being worst).
    * `scores[i]` corresponds to `business[i]` where `i={0,1,2}`

    ```javascript
    { "uid": suggestionId,
      "business":
        [
          { // This is business[0]
            'id':     business_yelp_id,
            'rating': business_yelp_rating,
            'name':   business_name,
            'coord':  business_coordinates,
            'display_address': business_display_address}
          },
          ...
        ],
      "scores":
        [
          business[0]_score,
          business[1]_score,
          business[2]_score
        ]   
      }
    ```

* **Error Response:**

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Event not found" }`

# Invite to Event
----
  Invites another user to an event.

* **URL**

  /inviteToEvent/\<username\>

* **Method:**

  `POST`

* **Data Params**

    ```javascript
    { "invited" : invited_username,
      "uid": event_uid}
    ```

* **Success Response Code:** 201 CREATED  
    **Content:** See [Event Object](#event-object)

* **Error Response:**

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Event not found" }`

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Shared user does not exist" }`

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Already sent invitation" }`

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Already shared with user" }`

# Get Event from ID
----
  Returns event object if the user has access to the event.

* **URL**

  /getEventFromId/\<username\>

* **Method:**

  `GET`

* **Data Params**

    ```javascript
    { "uid": event_uid }
    ```

* **Success Response Code:** 200 OK  
    **Content:** See [Event Object](#event-object)

* **Error Response:**

  * **Code:** 400 BAD REQUEST  
    **Content:** `{ error : "Event not found" }`

# Get Events For Itinerary
----
  Returns an event object array for all events for an existing itinerary.

* **URL**

  /getEventFromId/\<username\>

* **Method:**

  `GET`

* **Data Params**

    ```javascript
    { "date": itinerary_date }
    ```

* **Success Response Code:** 200 OK  
    **Content:** See [Event Object](#event-object)
    ```javascript
    { "events":
      [
        event_objects
      ]
    }
    ```

* **Error Response:**

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Itinerary for the day not found" }`

# Get Itinerary from ID
----
  Returns itinerary object data if the user created the itinerary.

* **URL**

  /getEventFromId/\<username\>

* **Method:**

  `GET`

* **Data Params**

    ```javascript
    { "uid": itinerary_uid }
    ```

* **Success Response Code:** 200 OK  
    **Content:** See [Itinerary Object](#itinerary-object)

* **Error Response:**

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Itinerary not found" }`

# Delete Itinerary
----
  Deletes itinerary object data if the user created the itinerary.

* **URL**

  /deleteItinerary/\<username\>

* **Method:**

  `DELETE`

* **Data Params**

    ```javascript
    { "uid": itinerary_uid }
    ```

* **Success Response Code:** 200 OK  
    **Content:** See [Itinerary Object](#itinerary-object)

* **Error Response:**

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Itinerary not found" }`

# Get Itinerary List
----
  Returns a list all of itineraries.

* **URL**

  /itinerarylistshells/\<username\>

* **Method:**

  `GET`

* **Data Params**

    ```javascript
    { }
    ```

* **Success Response Code:** 200 OK  
    **Content:** See [Itinerary Object](#itinerary-object)
    ```javascript
    { "itineraries":
      [
        itinerary_objects
      ]
    }
    ```

* **Error Response:**

  * **Code:** 400 BAD REQUEST <br />
    **Content:** `{ error : "Invalid username" }`

# Rate Place
----
  Rates a place by a user.

* **URL**

  /ratePlace/\<username\>

* **Method:**

  `POST`

* **Data Params**

    ```javascript
    { "uid": yelpId,
      "rating": 1-5 }
    ```

* **Success Response Code:** 200 OK  
    **Content:**
    ```javascript
    { "uid": yelpId,
      "ratings": [ all_past_ratings ] }
    ```

# Yelp Integration (Depreciated)
---
### [API Website](https://github.com/Yelp/yelp-python)
  Returns yelp data for a business given a query  
  NOTE: Use [/getSuggestions](#get-suggestions) instead

* **URL**

  /searchYelp/\<query\>

* **Method:**

  `GET`

* **Data Params**
    See API Website
    ```javascript
    // Example for Search API
    { 'term': 'food',
      'lang': 'fr'
    }
    ```

* **Success Response Code:** 200 OK  
    **Content:** Business info as shown on the website
    ```javascript
    { }
    ```

# Object Mappings
## User Object
```javascript
{
  "name":"Alex",
  "password":"b75bd008d5fecb1f50cf026532e8ae67",
  "username":"alex",
  "displayName": "Alex",
  "_id":{
    "$oid":"580598c52e526e0009738d25"
  },
}
```
## Itinerary Object
```javascript
{
  "uid":"2216454809391438062",
  "name":"itin1",
  "createdBy":"alex",
  "date":"2015-08-21T00:00:00.000Z",
  "_id":{
    "$oid":"58299d2df5b3ad000a167804"
  },
}
```
## Event Object
```javascript
{
  "uid": event_uid,
  "start": event_start_time,
  "end": event_end_time,
  "date": itinerary_date,
  "yelpId": location_yelp_id,
  "invited": [ user_objects ],
  "acceptedBy": [ user_objects ],
  "_id":{
     "$oid":"580598c52e526e0009738d25"
  },
}
```
